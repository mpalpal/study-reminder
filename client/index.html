<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Study Reminder</title>
  <link rel="stylesheet" href="/styles.css" />
  <link rel="manifest" href="/manifest.json" />
  <meta name="theme-color" content="#ffffff" />
</head>
<body>
  <!-- Splash Screen -->
  <div id="splash">
    <div class="splash-inner">
      <h1 class="splash-title">Study Reminder</h1>
    </div>
  </div>
  <header class="topbar">
    <button id="helpBtn" type="button" class="icon-btn" aria-label="使い方">?</button>
    <h1 class="app-title">Study Reminder</h1>
    <nav class="tabs">
      <a href="#review" id="tabReview" class="tab">復習</a>
      <a href="#record" id="tabRecord" class="tab">記録</a>
      <a href="#history" id="tabHistory" class="tab">履歴</a>
    </nav>
  </header>

  <main class="container">

    <!-- ===== 復習ページ ===== -->
    <section id="pageReview" class="page">
      <!-- 固定：昨日 -->
      <div class="card">
        <h3 id="fixed1Heading">—</h3>
        <ul id="fixed1List" class="list"></ul>
        <div id="fixed1Empty" class="muted box" style="display:none;">記録なし</div>
      </div>

      <!-- 固定：7日前 -->
      <div class="card">
        <h3 id="fixed7Heading">—</h3>
        <ul id="fixed7List" class="list"></ul>
        <div id="fixed7Empty" class="muted box" style="display:none;">記録なし</div>
      </div>

      <!-- 固定：14日前 -->
      <div class="card">
        <h3 id="fixed14Heading">—</h3>
        <ul id="fixed14List" class="list"></ul>
        <div id="fixed14Empty" class="muted box" style="display:none;">記録なし</div>
      </div>

      <!-- 選択：0〜30日前（折りたたみ） -->
      <details class="card" id="selectPanel">
        <summary class="summary">
          <span>▶︎過去の学習</span>
          <span class="muted" id="selectPanelHint"></span>
        </summary>

        <div class="row" style="align-items:flex-end; margin-top:10px;">
          <div style="flex:1;">
            <div class="label">日付</div>
            <select id="offsetSelect" class="select"></select>
          </div>
          <button id="setToTodayBtn" type="button" class="secondary">今日</button>
        </div>
          <h3 id="reviewHeading">—</h3>
          <ul id="reviewList" class="list"></ul>
          <div id="reviewEmpty" class="muted box" style="display:none;">記録なし</div>
      </details>

      <!-- 学習メモ（共通） -->
      <div class="card">
        <h3>学習メモ</h3>
        <div id="reviewDetail" class="box muted">タイトル選択で学習メモ表示</div>
      </div>
    </section>

    <!-- ===== 記録ページ ===== -->
    <section id="pageRecord" class="page" style="display:none;">
      <div class="card">
        <h2>今日の記録</h2>
        <p class="muted" id="todayLabel">—</p>

        <div class="field">
          <label class="label" for="title">タイトル</label>
          <input id="title" class="input" placeholder="例：財務会計論 X章" />
        </div>

        <div class="field">
          <label class="label" for="body">学習メモ</label>
          <textarea id="body" class="textarea" placeholder="例：問2は特に要復習"></textarea>
        </div>

        <div class="row">
          <button id="saveBtn" type="button">保存</button>
          <button id="cancelEditBtn" type="button" class="secondary" style="display:none;">編集を中止</button>
          <span id="msg" class="msg"></span>
        </div>
      </div>

      <div class="card">
        <h3>今日の学習</h3>
        <ul id="todayList" class="list"></ul>
        <div id="todayEmpty" class="muted box" style="display:none;">記録なし</div>
      </div>
      
    </section>
    <!-- ===== 履歴ページ ===== -->
    <section id="pageHistory" class="page" style="display:none;">
      <div class="card">
        <div class="row" style="align-items:center;">
          <h2 style="margin:0;">学習履歴</h2>
          <div style="margin-left:auto; display:flex; gap:8px;">
            <button id="calPrevBtn" type="button" class="secondary">＜</button>
            <button id="calTodayBtn" type="button" class="secondary">今月</button>
            <button id="calNextBtn" type="button" class="secondary">＞</button>
          </div>
        </div>
        <p id="calMonthLabel" class="muted" style="margin:8px 0 0;">—</p>
      </div>

      <div class="card">
        <div id="calendar" class="calendar"></div>
        <p class="muted" style="font-size:12px;margin-top:10px;">※ 学習記録がある日はピンクで表示</p>
      </div>

      <div class="card">
        <h3 id="historyDateLabel">日付を選択してください</h3>
        <ul id="historyList" class="list"></ul>
        <div id="historyEmpty" class="muted box" style="display:none;">記録なし</div>
      </div>

      <div class="card">
        <h3>編集 / 追加</h3>
        <p class="muted" id="historyEditingInfo">日付とタイトルを選択で編集 / 日付選択で追加</p>

        <div class="field">
          <label class="label" for="historyTitle">タイトル</label>
          <input id="historyTitle" class="input" placeholder="例：財務会計論 X章 → Y章" />
        </div>

        <div class="field">
          <label class="label" for="historyBody">学習メモ</label>
          <textarea id="historyBody" class="textarea" placeholder="例：問2は特に要復習 → 問2-2は特に要復習"></textarea>
        </div>

        <div class="row">
          <button id="historyAddBtn" type="button">追加</button>
          <button id="historySaveBtn" type="button">更新</button>
          <button id="historyCancelBtn" type="button" class="secondary">編集を中止</button>
          <span id="historyMsg" class="msg"></span>
        </div>
      </div>

      <div class="card">
        <h3>バックアップ (JSON)</h3>
        <p class="muted">iCloud Driveにデータ保存</p>

        <div class="row" style="justify-content:flex-start; gap:10px; flex-wrap:wrap;">
          <button id="exportBtn" type="button">エクスポート</button>

          <div class="file-btn">
            <button id="importBtn" type="button">インポート</button>
            <input id="importFile" type="file" accept="application/json" />
          </div>

          <button id="wipeBtn" type="button" class="danger">記録削除</button>
        </div>

        <p id="backupMsg" class="msg"></p>
      </div>
    </section>

  </main>

  <script src="/main.js" defer></script>

  <!-- Help Modal -->
  <div id="helpModal" class="modal" style="display:none;">
    <div class="modal-backdrop" id="helpBackdrop"></div>

    <div class="modal-panel" role="dialog" aria-modal="true" aria-label="使い方">
      <div class="modal-head">
        <div class="modal-title">使い方</div>
        <button id="helpClose" type="button" class="icon-btn" aria-label="閉じる">×</button>
      </div>

      <div class="modal-body">
        <div class="help-image-wrap">
          <img class="help-image" src="/help.png" alt="Study Reminder 使い方" />
        </div>
      </div>
    </div>
  </div>
  </body>
</html>